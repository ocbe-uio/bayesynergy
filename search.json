[{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Advanced_topics.html","id":"diagnosing-errors-and-warnings","dir":"Articles","previous_headings":"","what":"Diagnosing errors and warnings","title":"Advanced topics","text":"Sometimes, bayesynergy function may return warning. Ideally, don’t want warnings , examined closely, posterior samples unreliable. Usually, warning tell user fix problem hand, e.g. running chains longer (set iter higher), setting adapt_delta higher. See [https://mc-stan.org/misc/warnings.html] general tips.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Advanced_topics.html","id":"divergent-transitions","dir":"Articles","previous_headings":"Diagnosing errors and warnings","what":"Divergent Transitions","title":"Advanced topics","text":"commonly, sampler might complain divergent transitions. warning typically look like : indicative posterior geometry tricky explore. case divergent transitions, usual trick set adapt_delta higher value, .e. larger 0.9 default. can done control option bayesynergy call: However, case , 2316 divergent transitions, indicative misspecified model. experience, can happen reasons. .e. parameter \\(l\\) close one. can effect making monotherapy parameters unidentifiable. can usually alleviated setting lower_asymptotes = FALSE call. Unless one specifically interested parameters, reason estimate – model fit typically still good without . model can struggle setting, particularly none replicates. choose homoscedastic model instead. sometimes setting \\(\\lambda\\) much lower initial setting can help better fit. particularly true viability scores close zero (negative) truncated set exactly zero.","code":"## Warning: There were 2316 divergent transitions after warmup. See ## http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup ## to find out why this is a problem and how to eliminate them. fit = bayesynergy(y, x, control = list(adapt_delta = 0.99))"},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Advanced_topics.html","id":"robustness-against-outliers","dir":"Articles","previous_headings":"","what":"Robustness against outliers","title":"Advanced topics","text":"provide version model robust inevitable outliers dose=response data. done swapping two components model formulation, likelihood prior kernel hyperparameters. likelihood, utilise log-Pareto-tailed Normal (LPTN) distribution mean \\(\\mu\\) standard deviation \\(\\sigma\\), described Gagnon, Desgagné, Bédard (2020) takes form \\[ f(x)= \\begin{cases} \\frac{1}{\\sigma}\\phi\\left(\\frac{x-\\mu}{\\sigma}\\right) & \\text{} \\vert\\frac{x-\\mu}{\\sigma}\\vert \\leq \\tau \\\\ \\frac{1}{\\sigma}\\phi(\\tau)\\frac{\\tau}{\\vert\\frac{x-\\mu}{\\sigma}\\vert}\\left(\\frac{\\log (\\tau)}{\\log(\\vert\\frac{x-\\mu}{\\sigma}\\vert)}\\right)^{\\lambda+1} & \\text{} \\vert\\frac{x-\\mu}{\\sigma}\\vert > \\tau \\end{cases} \\] \\(\\phi\\) denotes standard normal pdf. parameters \\((\\tau,\\lambda)\\) controlled user-specified hyperparameter \\(\\rho \\(2\\Phi(1)-1,1)\\) \\[ \\tau=\\Phi^{-1}((1+\\rho)/2),  \\ \\ \\ \\ \\lambda=2(1-\\rho)^{-1}\\phi(\\tau)\\tau\\log(\\tau) \\] robust likelihood can utilized setting robust = T calling thebayesynergy function. user-specified parameter \\(\\rho\\) can set rho argument, default set \\(0.9\\). kernel, recommend utilising Matérn kernel Penalized Complexity (PC) prior kernel hyperparameters. PC prior Matern covariance described Fuglstad et al. (2018), strongly encourages small deviations null model, .e. high probability interaction term zero. PC prior kernel hyperparameters \\((\\sigma_f^2,\\ell)\\) (2-dimensional case) takes form \\[ \\pi(\\sigma_f^2,\\ell)=\\tilde{\\lambda}_1\\tilde{\\lambda}_2\\ell^{-2}\\sigma_f^{-1}\\exp\\left(-\\tilde{\\lambda}_1\\ell^{-1}-\\tilde{\\lambda}_2\\sigma_f\\right), \\] \\((\\tilde{\\lambda}_1,\\tilde{\\lambda}_2)\\) set reflect prior beliefs \\(P(\\ell < \\ell_0)=\\alpha_1\\) \\(P(\\sigma_f^2 > \\sigma^2_{f0})=\\alpha_2\\) \\[ \\tilde{\\lambda}_1=-\\log(-\\alpha_1)\\ell \\ \\ \\ \\ \\tilde{\\lambda}_2=-\\frac{\\log(\\alpha_2)}{\\sigma_{f0}^2}, \\] \\((\\ell_0,\\alpha_1,\\sigma_{f0}^2,\\alpha_2)\\) hyperparameters set user. PC prior can enabled setting pcprior = T calling bayesynergy function, hyperparameters specified argument pcprior_hypers. default, recommend \\((\\ell_0,\\alpha_1,\\sigma_{f0}^2,\\alpha_2)=(1,0.1,1,0.2)\\).","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Advanced_topics.html","id":"including-controls","dir":"Articles","previous_headings":"","what":"Including controls","title":"Advanced topics","text":"positive negative controls essentially control signal--noise ratio cell viability assays. user access , can included model help calibrate posterior distribution – particularly case zero replicates. Let \\(\\xi^-_k\\) \\(\\xi^+_l\\) denote negative positive controls \\(k=1,\\ldots,n_-\\) \\(l=1,\\ldots,n_+\\). measurements raw readings plate used calculate cell viability. additional well, treated drug concentration \\(\\mathbf{x}_i\\), denote raw output \\(\\xi_i\\), calculate cell viability well formula: \\[ y_i = \\frac{\\xi_i-\\tilde{\\xi^+}}{\\tilde{\\xi^-}-\\tilde{\\xi^+}}, \\] \\(\\tilde{\\xi^-}\\) \\(\\tilde{\\xi^+}\\) denotes measure centrality positive negative controls, typically mean median. controls can passed function converted % viability. variances normalized controls, \\(\\lambda\\) can set indicated . negative controls can added directly algorithm. Negative controls represents unhindered cell growth, can thought samples dose-response function \\(f(\\mathbf{x})\\) concentration \\(\\mathbf{x}=(0,0)\\). can added directly \\(\\texttt{bayesynergy}\\) function way regular observations.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Advanced_topics.html","id":"synergy-classification","dir":"Articles","previous_headings":"","what":"Synergy classification","title":"Advanced topics","text":"Frequently, interest classify experiment synergistic antagonistic. Usually, done thresholding synergy measure certain level, declaring e.g. everything 10 synergistic, everything -10 antagonistic, anything additive (interaction). problem completely ignores underlying measurement error, consequence thresholding procedure can lead misclassification. Large synergistic effects might classified synergistic, reality effect discerned background noise. manner, genuine synergistic effects small, example dose-ranges bit , also misclassified. incorporating uncertainty classification can done principled manner. Bayesian inference, can compute know model evidence. , given probabilistic model \\(\\mathcal{M}\\), data think generated , \\(\\mathcal{D}\\), evidence defined probability model given data, \\(P(\\mathcal{M} \\vert \\mathcal{D})\\). can use quantity compare different models, particular comparing two distinct models can define Bayes Factor, \\(\\text{BF}_{10}\\): \\[ \\text{BF}_{10}=\\frac{P(\\mathcal{D}\\vert\\mathcal{M}_1)}{P(\\mathcal{D}\\vert\\mathcal{M}_0)} = \\frac{P(\\mathcal{M}_1 \\vert \\mathcal{D})}{P(\\mathcal{M}_0 \\vert \\mathcal{D})}\\frac{P(\\mathcal{M}_1)}{P(\\mathcal{M}_0)}, \\] \\(P(\\mathcal{M}_1)\\) \\(P(\\mathcal{M}_0)\\) denotes prior model probabilities. defining \\[ \\mathcal{M}_0: f(\\mathbf{x}) = p_0(\\mathbf{x}) \\\\ \\mathcal{M}_1: f(\\mathbf{x}) = p_0(\\mathbf{x}) + \\Delta(\\mathbf{x}), \\] computing \\(\\text{BF}_{10}\\), Bayes factor gives information whether interaction surface needs included model. high value indicates \\(\\mathcal{M}_1\\) preferred \\(\\mathcal{M}_0\\), thus likely interaction experiment. One still needs make cutoff, less arbitrary connecting directly uncertainty model, model evidence. thresholding can done according e.g. table Kass Raftery (1995): Bayes factor gives information whether interaction present. Depending classification task, one still needs decide effect synergistic antagonistic. one e.g. use integral interaction surface, \\(\\text{VUS}(\\Delta)\\), negative experiment coded synergistic, positive coded antagonistic. calculation Bayes factor implemented directly bayesynergy function, can calculated simply adding bayes_factor = T call. Model evidence Bayes factor computed via bridgesampling package (Gronau, Singmann, Wagenmakers (2020)).","code":""},{"path":[]},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Example_screen.html","id":"melanoma-cell-line-example","dir":"Articles","previous_headings":"","what":"Melanoma cell line example","title":"Example: Multiple experiments","text":"Included package result synergyscreen run 583 drug combinations -375 human melanoma cell line ONeil et al. (2016). synergyscreen object list two entries, dataframe parameter estimates experiment, list entitled failed – containing experiments either failed completely process, unsatisfactory fit. see dataset two experiments failed process, initial run synergyscreen. ’s multitude reasons experiment might fail process, input error, initialization problems problems parallel processing. entries failed lists, containing necessary information process bayesynergy function can rerun experiments failed process, simply passing returned synergyscreen object back function. Note turn default options saving fit plotting everything, set method = \"vb\" indicating use variational inference fit model.","code":"library(bayesynergy) data(\"ONeil_A375\") length(ONeil_A375$failed) ## [1] 2 failed_experiment = ONeil_A375$failed[[1]] names(failed_experiment) ## [1] \"y\"             \"x\"             \"drug_names\"    \"experiment_ID\" head(cbind(failed_experiment$y,failed_experiment$x)) ##      viability L778123 MK-4827 ## [1,]     0.759   0.325   0.223 ## [2,]     0.755   0.325   0.775 ## [3,]     0.548   0.325   2.750 ## [4,]     0.307   0.325  10.000 ## [5,]     0.787   0.800   0.223 ## [6,]     0.820   0.800   0.775 fit_screen = synergyscreen(ONeil_A375, save_raw = F, save_plots = F, parallel = F,                             bayesynergy_params = list(method = \"vb\")) ## Chain 1: ------------------------------------------------------------ ## Chain 1: EXPERIMENTAL ALGORITHM: ## Chain 1:   This procedure has not been thoroughly tested and may be unstable ## Chain 1:   or buggy. The interface is subject to change. ## Chain 1: ------------------------------------------------------------ ## Chain 1:  ## Chain 1:  ## Chain 1:  ## Chain 1: Gradient evaluation took 0.000286 seconds ## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.86 seconds. ## Chain 1: Adjust your expectations accordingly! ## Chain 1:  ## Chain 1:  ## Chain 1: Begin eta adaptation. ## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation) ## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation) ## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation) ## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation) ## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation) ## Chain 1: Iteration: 250 / 250 [100%]  (Adaptation) ## Chain 1: Success! Found best value [eta = 0.1]. ## Chain 1:  ## Chain 1: Begin stochastic gradient ascent. ## Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  ## Chain 1:    100         -872.691             1.000            1.000 ## Chain 1:    200        -2810.419             0.845            1.000 ## Chain 1:    300         -836.057             1.350            1.000 ## Chain 1:    400         -681.562             1.069            1.000 ## Chain 1:    500         -712.323             0.864            0.689 ## Chain 1:    600         -767.722             0.732            0.689 ## Chain 1:    700         -876.125             0.645            0.227 ## Chain 1:    800         -765.378             0.583            0.227 ## Chain 1:    900         -866.489             0.531            0.145 ## Chain 1:   1000         -833.558             0.482            0.145 ## Chain 1:   1100         -573.027             0.427            0.145 ## Chain 1:   1200         -662.226             0.372            0.135 ## Chain 1:   1300         -635.603             0.140            0.124 ## Chain 1:   1400         -530.197             0.137            0.124 ## Chain 1:   1500         -696.742             0.157            0.135 ## Chain 1:   1600         -662.597             0.155            0.135 ## Chain 1:   1700         -410.396             0.204            0.145 ## Chain 1:   1800         -617.779             0.223            0.199 ## Chain 1:   1900         -520.168             0.230            0.199 ## Chain 1:   2000         -602.568             0.240            0.199 ## Chain 1:   2100         -589.955             0.196            0.188 ## Chain 1:   2200         -720.613             0.201            0.188 ## Chain 1:   2300         -494.977             0.242            0.199 ## Chain 1:   2400         -593.704             0.239            0.188 ## Chain 1:   2500         -385.606             0.269            0.188 ## Chain 1:   2600         -469.619             0.282            0.188 ## Chain 1:   2700         -464.925             0.221            0.181 ## Chain 1:   2800         -336.845             0.226            0.181 ## Chain 1:   2900         -418.252             0.227            0.181 ## Chain 1:   3000         -443.966             0.219            0.181 ## Chain 1:   3100         -384.049             0.232            0.181 ## Chain 1:   3200         -410.655             0.220            0.179 ## Chain 1:   3300         -329.484             0.199            0.179 ## Chain 1:   3400         -409.447             0.202            0.195 ## Chain 1:   3500         -297.374             0.186            0.195 ## Chain 1:   3600         -412.905             0.196            0.195 ## Chain 1:   3700         -422.740             0.198            0.195 ## Chain 1:   3800         -432.471             0.162            0.195 ## Chain 1:   3900         -391.699             0.153            0.156 ## Chain 1:   4000         -311.214             0.173            0.195 ## Chain 1:   4100         -323.960             0.161            0.195 ## Chain 1:   4200         -341.184             0.160            0.195 ## Chain 1:   4300         -286.686             0.154            0.190 ## Chain 1:   4400         -406.179             0.164            0.190 ## Chain 1:   4500         -335.606             0.147            0.190 ## Chain 1:   4600         -303.263             0.130            0.107 ## Chain 1:   4700         -294.390             0.131            0.107 ## Chain 1:   4800         -500.156             0.170            0.190 ## Chain 1:   4900         -220.376             0.286            0.210 ## Chain 1:   5000         -272.821             0.279            0.192 ## Chain 1:   5100         -239.719             0.289            0.192 ## Chain 1:   5200         -232.594             0.287            0.192 ## Chain 1:   5300         -287.391             0.287            0.192 ## Chain 1:   5400         -251.678             0.272            0.191 ## Chain 1:   5500         -238.362             0.257            0.142 ## Chain 1:   5600         -223.528             0.253            0.142 ## Chain 1:   5700         -228.233             0.252            0.142 ## Chain 1:   5800         -228.044             0.211            0.138 ## Chain 1:   5900         -234.840             0.087            0.066 ## Chain 1:   6000         -248.028             0.073            0.056 ## Chain 1:   6100         -290.744             0.074            0.056 ## Chain 1:   6200         -329.963             0.082            0.066 ## Chain 1:   6300         -263.016             0.089            0.066 ## Chain 1:   6400         -200.508             0.106            0.066 ## Chain 1:   6500         -204.821             0.102            0.066 ## Chain 1:   6600         -194.921             0.101            0.053 ## Chain 1:   6700         -189.982             0.101            0.053 ## Chain 1:   6800         -186.064             0.103            0.053 ## Chain 1:   6900         -200.948             0.108            0.074 ## Chain 1:   7000         -190.686             0.108            0.074 ## Chain 1:   7100         -163.066             0.110            0.074 ## Chain 1:   7200         -184.732             0.110            0.074 ## Chain 1:   7300         -204.923             0.094            0.074 ## Chain 1:   7400         -181.190             0.076            0.074 ## Chain 1:   7500         -188.195             0.078            0.074 ## Chain 1:   7600         -165.687             0.086            0.099 ## Chain 1:   7700         -187.954             0.096            0.117 ## Chain 1:   7800         -330.458             0.137            0.118 ## Chain 1:   7900         -175.064             0.218            0.131 ## Chain 1:   8000         -165.129             0.219            0.131 ## Chain 1:   8100         -160.241             0.205            0.118 ## Chain 1:   8200         -155.766             0.196            0.118 ## Chain 1:   8300         -142.677             0.195            0.118 ## Chain 1:   8400         -159.317             0.193            0.104 ## Chain 1:   8500         -146.323             0.198            0.104 ## Chain 1:   8600         -151.373             0.188            0.092 ## Chain 1:   8700         -154.764             0.178            0.089 ## Chain 1:   8800         -139.190             0.146            0.089 ## Chain 1:   8900         -121.017             0.072            0.089 ## Chain 1:   9000         -136.755             0.078            0.092 ## Chain 1:   9100         -136.237             0.075            0.092 ## Chain 1:   9200         -136.405             0.072            0.092 ## Chain 1:   9300         -132.323             0.066            0.089 ## Chain 1:   9400         -129.465             0.058            0.033 ## Chain 1:   9500         -110.904             0.066            0.033 ## Chain 1:   9600         -122.228             0.072            0.093 ## Chain 1:   9700         -143.913             0.085            0.112 ## Chain 1:   9800         -128.041             0.086            0.115 ## Chain 1:   9900         -114.042             0.083            0.115 ## Chain 1:   10000         -130.366             0.084            0.123 ## Chain 1: Informational Message: The maximum number of iterations is reached! The algorithm may not have converged. ## Chain 1: This variational approximation is not guaranteed to be meaningful. ## Chain 1:  ## Chain 1: Drawing a sample of size 1000 from the approximate posterior...  ## Chain 1: COMPLETED. ## Chain 1: ------------------------------------------------------------ ## Chain 1: EXPERIMENTAL ALGORITHM: ## Chain 1:   This procedure has not been thoroughly tested and may be unstable ## Chain 1:   or buggy. The interface is subject to change. ## Chain 1: ------------------------------------------------------------ ## Chain 1:  ## Chain 1:  ## Chain 1:  ## Chain 1: Gradient evaluation took 0.000238 seconds ## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.38 seconds. ## Chain 1: Adjust your expectations accordingly! ## Chain 1:  ## Chain 1:  ## Chain 1: Begin eta adaptation. ## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation) ## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation) ## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation) ## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation) ## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation) ## Chain 1: Iteration: 250 / 250 [100%]  (Adaptation) ## Chain 1: Success! Found best value [eta = 0.1]. ## Chain 1:  ## Chain 1: Begin stochastic gradient ascent. ## Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  ## Chain 1:    100        -2735.584             1.000            1.000 ## Chain 1:    200        -1614.516             0.847            1.000 ## Chain 1:    300        -2049.330             0.636            0.694 ## Chain 1:    400        -2267.551             0.501            0.694 ## Chain 1:    500        -1498.701             0.503            0.513 ## Chain 1:    600        -1502.268             0.420            0.513 ## Chain 1:    700        -1384.657             0.372            0.212 ## Chain 1:    800        -1716.107             0.350            0.212 ## Chain 1:    900        -1768.855             0.314            0.193 ## Chain 1:   1000        -1389.875             0.310            0.212 ## Chain 1:   1100        -1560.950             0.221            0.193 ## Chain 1:   1200        -1257.443             0.176            0.193 ## Chain 1:   1300        -1380.180             0.163            0.110 ## Chain 1:   1400        -1401.704             0.155            0.110 ## Chain 1:   1500        -1354.093             0.107            0.089 ## Chain 1:   1600         -982.610             0.145            0.110 ## Chain 1:   1700        -1182.535             0.153            0.169 ## Chain 1:   1800         -760.108             0.190            0.169 ## Chain 1:   1900        -1097.352             0.217            0.241 ## Chain 1:   2000         -723.453             0.242            0.241 ## Chain 1:   2100         -700.271             0.234            0.241 ## Chain 1:   2200         -865.258             0.229            0.191 ## Chain 1:   2300         -832.921             0.224            0.191 ## Chain 1:   2400         -712.333             0.239            0.191 ## Chain 1:   2500         -728.364             0.238            0.191 ## Chain 1:   2600         -630.700             0.216            0.169 ## Chain 1:   2700         -606.565             0.203            0.169 ## Chain 1:   2800         -515.754             0.165            0.169 ## Chain 1:   2900         -671.280             0.157            0.169 ## Chain 1:   3000         -632.585             0.112            0.155 ## Chain 1:   3100         -620.683             0.110            0.155 ## Chain 1:   3200         -516.664             0.111            0.155 ## Chain 1:   3300         -582.550             0.119            0.155 ## Chain 1:   3400         -609.514             0.106            0.113 ## Chain 1:   3500         -934.114             0.139            0.155 ## Chain 1:   3600         -616.974             0.175            0.176 ## Chain 1:   3700         -496.624             0.195            0.201 ## Chain 1:   3800         -591.756             0.194            0.201 ## Chain 1:   3900         -503.037             0.188            0.176 ## Chain 1:   4000         -516.856             0.185            0.176 ## Chain 1:   4100         -440.113             0.200            0.176 ## Chain 1:   4200         -460.137             0.184            0.174 ## Chain 1:   4300         -551.502             0.190            0.174 ## Chain 1:   4400         -542.362             0.187            0.174 ## Chain 1:   4500         -466.048             0.168            0.166 ## Chain 1:   4600         -440.665             0.123            0.164 ## Chain 1:   4700         -319.879             0.136            0.164 ## Chain 1:   4800         -435.135             0.147            0.166 ## Chain 1:   4900         -371.283             0.146            0.166 ## Chain 1:   5000         -317.452             0.161            0.170 ## Chain 1:   5100         -435.446             0.170            0.170 ## Chain 1:   5200         -344.543             0.192            0.172 ## Chain 1:   5300         -332.615             0.179            0.172 ## Chain 1:   5400         -313.650             0.184            0.172 ## Chain 1:   5500         -319.804             0.169            0.172 ## Chain 1:   5600         -310.769             0.166            0.172 ## Chain 1:   5700         -310.048             0.129            0.170 ## Chain 1:   5800         -364.207             0.117            0.149 ## Chain 1:   5900         -278.928             0.131            0.149 ## Chain 1:   6000         -295.994             0.119            0.060 ## Chain 1:   6100         -270.138             0.102            0.060 ## Chain 1:   6200         -270.443             0.076            0.058 ## Chain 1:   6300         -229.945             0.090            0.060 ## Chain 1:   6400         -234.226             0.085            0.058 ## Chain 1:   6500         -268.133             0.096            0.096 ## Chain 1:   6600         -221.694             0.114            0.126 ## Chain 1:   6700         -263.252             0.130            0.149 ## Chain 1:   6800         -209.544             0.140            0.158 ## Chain 1:   6900         -255.033             0.128            0.158 ## Chain 1:   7000         -248.736             0.125            0.158 ## Chain 1:   7100         -193.734             0.143            0.176 ## Chain 1:   7200         -243.337             0.164            0.178 ## Chain 1:   7300         -188.302             0.175            0.204 ## Chain 1:   7400         -213.995             0.185            0.204 ## Chain 1:   7500         -204.620             0.177            0.204 ## Chain 1:   7600         -211.831             0.160            0.178 ## Chain 1:   7700         -176.698             0.164            0.199 ## Chain 1:   7800         -201.347             0.150            0.178 ## Chain 1:   7900         -186.182             0.141            0.122 ## Chain 1:   8000         -175.318             0.144            0.122 ## Chain 1:   8100         -183.064             0.120            0.120 ## Chain 1:   8200         -183.683             0.100            0.081 ## Chain 1:   8300         -174.428             0.076            0.062 ## Chain 1:   8400         -136.572             0.092            0.062 ## Chain 1:   8500         -146.549             0.094            0.068 ## Chain 1:   8600         -158.732             0.099            0.077 ## Chain 1:   8700         -154.733             0.081            0.068 ## Chain 1:   8800         -153.156             0.070            0.062 ## Chain 1:   8900         -139.400             0.072            0.062 ## Chain 1:   9000         -152.031             0.074            0.068 ## Chain 1:   9100         -115.362             0.101            0.077 ## Chain 1:   9200         -143.655             0.121            0.083 ## Chain 1:   9300         -135.921             0.121            0.083 ## Chain 1:   9400         -132.275             0.096            0.077 ## Chain 1:   9500         -134.199             0.091            0.077 ## Chain 1:   9600         -121.285             0.094            0.083 ## Chain 1:   9700         -112.478             0.099            0.083 ## Chain 1:   9800         -130.174             0.112            0.099 ## Chain 1:   9900         -131.446             0.103            0.083 ## Chain 1:   10000         -128.993             0.096            0.078 ## Chain 1: Informational Message: The maximum number of iterations is reached! The algorithm may not have converged. ## Chain 1: This variational approximation is not guaranteed to be meaningful. ## Chain 1:  ## Chain 1: Drawing a sample of size 1000 from the approximate posterior...  ## Chain 1: COMPLETED. ## Chain 1: ------------------------------------------------------------ ## Chain 1: EXPERIMENTAL ALGORITHM: ## Chain 1:   This procedure has not been thoroughly tested and may be unstable ## Chain 1:   or buggy. The interface is subject to change. ## Chain 1: ------------------------------------------------------------ ## Chain 1:  ## Chain 1:  ## Chain 1:  ## Chain 1: Gradient evaluation took 0.000225 seconds ## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 2.25 seconds. ## Chain 1: Adjust your expectations accordingly! ## Chain 1:  ## Chain 1:  ## Chain 1: Begin eta adaptation. ## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation) ## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation) ## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation) ## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation) ## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation) ## Chain 1: Iteration: 250 / 250 [100%]  (Adaptation) ## Chain 1: Success! Found best value [eta = 0.1]. ## Chain 1:  ## Chain 1: Begin stochastic gradient ascent. ## Chain 1:   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  ## Chain 1:    100       -15767.266             1.000            1.000 ## Chain 1:    200       -12410.519             0.635            1.000 ## Chain 1:    300       -15187.479             0.484            0.270 ## Chain 1:    400        -9426.197             0.516            0.611 ## Chain 1:    500       -11383.766             0.447            0.270 ## Chain 1:    600       -12474.991             0.387            0.270 ## Chain 1:    700        -6659.096             0.457            0.270 ## Chain 1:    800        -6461.860             0.403            0.270 ## Chain 1:    900        -6974.883             0.367            0.183 ## Chain 1:   1000        -6906.230             0.331            0.183 ## Chain 1:   1100        -7471.014             0.239            0.172 ## Chain 1:   1200        -6340.865             0.229            0.172 ## Chain 1:   1300        -9439.057             0.244            0.172 ## Chain 1:   1400        -5807.462             0.245            0.172 ## Chain 1:   1500        -7400.536             0.250            0.178 ## Chain 1:   1600        -5592.264             0.273            0.215 ## Chain 1:   1700        -4985.993             0.198            0.178 ## Chain 1:   1800        -6088.797             0.213            0.181 ## Chain 1:   1900        -5914.848             0.209            0.181 ## Chain 1:   2000        -5861.731             0.209            0.181 ## Chain 1:   2100        -5262.495             0.213            0.181 ## Chain 1:   2200        -4036.574             0.225            0.215 ## Chain 1:   2300        -3364.937             0.212            0.200 ## Chain 1:   2400        -4879.810             0.181            0.200 ## Chain 1:   2500        -3681.451             0.192            0.200 ## Chain 1:   2600        -3989.221             0.167            0.181 ## Chain 1:   2700        -3397.910             0.172            0.181 ## Chain 1:   2800        -3352.924             0.156            0.174 ## Chain 1:   2900        -2806.925             0.172            0.195 ## Chain 1:   3000        -2827.631             0.172            0.195 ## Chain 1:   3100        -2966.916             0.165            0.195 ## Chain 1:   3200        -3090.705             0.139            0.174 ## Chain 1:   3300        -3212.480             0.123            0.077 ## Chain 1:   3400        -3179.921             0.093            0.047 ## Chain 1:   3500        -3087.205             0.063            0.040 ## Chain 1:   3600        -3123.454             0.057            0.038 ## Chain 1:   3700        -2852.197             0.049            0.038 ## Chain 1:   3800        -2865.865             0.048            0.038 ## Chain 1:   3900        -2131.599             0.063            0.038 ## Chain 1:   4000        -2614.404             0.081            0.040 ## Chain 1:   4100        -2072.672             0.102            0.040 ## Chain 1:   4200        -2601.447             0.118            0.095 ## Chain 1:   4300        -2273.527             0.129            0.144 ## Chain 1:   4400        -1903.190             0.147            0.185 ## Chain 1:   4500        -1787.130             0.151            0.185 ## Chain 1:   4600        -1540.078             0.166            0.185 ## Chain 1:   4700        -2113.704             0.183            0.195 ## Chain 1:   4800        -1760.041             0.203            0.201 ## Chain 1:   4900        -1797.699             0.171            0.195 ## Chain 1:   5000        -1871.625             0.156            0.195 ## Chain 1:   5100        -1465.475             0.158            0.195 ## Chain 1:   5200        -1627.663             0.147            0.160 ## Chain 1:   5300        -1688.336             0.137            0.160 ## Chain 1:   5400        -1827.096             0.125            0.100 ## Chain 1:   5500        -2069.126             0.130            0.117 ## Chain 1:   5600        -1719.513             0.134            0.117 ## Chain 1:   5700        -1245.381             0.145            0.117 ## Chain 1:   5800        -1666.869             0.150            0.117 ## Chain 1:   5900        -1218.997             0.185            0.203 ## Chain 1:   6000        -1370.943             0.192            0.203 ## Chain 1:   6100        -1281.022             0.171            0.117 ## Chain 1:   6200        -1178.579             0.170            0.117 ## Chain 1:   6300        -1296.331             0.176            0.117 ## Chain 1:   6400        -1282.978             0.169            0.117 ## Chain 1:   6500        -1586.321             0.176            0.191 ## Chain 1:   6600        -1158.307             0.193            0.191 ## Chain 1:   6700        -1153.524             0.155            0.111 ## Chain 1:   6800        -1127.650             0.132            0.091 ## Chain 1:   6900         -950.748             0.114            0.091 ## Chain 1:   7000         -935.063             0.105            0.087 ## Chain 1:   7100        -1086.362             0.112            0.091 ## Chain 1:   7200        -1227.404             0.115            0.115 ## Chain 1:   7300        -1065.972             0.121            0.139 ## Chain 1:   7400         -773.281             0.157            0.151 ## Chain 1:   7500         -975.472             0.159            0.151 ## Chain 1:   7600         -915.561             0.129            0.139 ## Chain 1:   7700         -843.880             0.137            0.139 ## Chain 1:   7800         -782.343             0.142            0.139 ## Chain 1:   7900         -791.908             0.125            0.115 ## Chain 1:   8000         -882.870             0.134            0.115 ## Chain 1:   8100         -888.817             0.120            0.103 ## Chain 1:   8200         -878.290             0.110            0.085 ## Chain 1:   8300         -743.055             0.113            0.085 ## Chain 1:   8400         -750.857             0.076            0.079 ## Chain 1:   8500         -730.538             0.058            0.065 ## Chain 1:   8600         -692.753             0.057            0.055 ## Chain 1:   8700         -618.247             0.061            0.055 ## Chain 1:   8800         -671.403             0.061            0.055 ## Chain 1:   8900         -682.342             0.061            0.055 ## Chain 1:   9000         -627.008             0.060            0.055 ## Chain 1:   9100         -626.038             0.059            0.055 ## Chain 1:   9200         -630.552             0.059            0.055 ## Chain 1:   9300         -609.115             0.044            0.035 ## Chain 1:   9400         -536.458             0.057            0.055 ## Chain 1:   9500         -564.460             0.059            0.055 ## Chain 1:   9600         -498.034             0.067            0.079 ## Chain 1:   9700         -519.581             0.059            0.050 ## Chain 1:   9800         -567.869             0.059            0.050 ## Chain 1:   9900         -541.627             0.063            0.050 ## Chain 1:   10000         -487.533             0.065            0.050 ## Chain 1: Informational Message: The maximum number of iterations is reached! The algorithm may not have converged. ## Chain 1: This variational approximation is not guaranteed to be meaningful. ## Chain 1:  ## Chain 1: Drawing a sample of size 1000 from the approximate posterior...  ## Chain 1: COMPLETED."},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Example_screen.html","id":"visualization","dir":"Articles","previous_headings":"","what":"Visualization","title":"Example: Multiple experiments","text":"can also plot result screen:","code":"plot(fit_screen)"},{"path":[]},{"path":[]},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Example_single.html","id":"monotherapy-curves-2d-contour-plots","dir":"Articles","previous_headings":"Visualization","what":"Monotherapy curves, 2D contour plots","title":"Example: Single experiment","text":"can also create plots simply running  produces monotherapy curves, monotherapy summary statistics, 2D contour plots dose-response function \\(f\\), non-interaction assumption \\(p_0\\) interaction \\(\\Delta\\). last plot displays \\(rVUS\\) scores discussed previously, corresponding uncertainty.","code":"plot(fit, plot3D = F)"},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Example_single.html","id":"d-interactive-plots","dir":"Articles","previous_headings":"Visualization","what":"3D interactive plots","title":"Example: Single experiment","text":"package can also generate 3D interactive plots setting plot3D = T. displayed following using plotly library (Plotly Technologies Inc. (2015)).","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Model.html","id":"the-model","dir":"Articles","previous_headings":"","what":"The model","title":"Mathematical model","text":"dose-response function \\(f:\\boldsymbol{x} \\(0,1)\\), maps drug concentrations \\(\\boldsymbol{x}\\) measure cell viability – zero corresponding cells dead treatment, one corresponding cells still alive. drug-combination screens, common assume dose-response function can broken \\[ f(\\boldsymbol{x}) = p_0(\\boldsymbol{x})+\\Delta(\\boldsymbol{x}), \\] \\(p_0(\\boldsymbol{x})\\) encodes non-interaction assumption, \\(\\Delta(\\boldsymbol{x})\\) captures residual interaction effect.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Model.html","id":"non-interaction","dir":"Articles","previous_headings":"The model","what":"Non-interaction","title":"Mathematical model","text":"non-interaction assumption, \\(p_0(\\boldsymbol{x})\\), captures can reasonably assumed joint drug effect, given estimates drugs’ individual effect. assume Bliss style independence assumption, first assume individual drugs’ dose-response function takes form log-logistic curve \\[ h_i(x_i|l,s,m) = l + \\frac{1-l}{1+10^{s(x_i-m)}}, \\] \\(l\\) lower-asymptote, \\(s\\) slope, \\(m\\) drugs ‘EC-50’ \\(\\log_{10}\\) scale. Bliss assumption amounts probabilistic independence assumption, \\[ p_0(\\boldsymbol{x}) = h_1(x_1|l_1,s_1,m_1) \\ h_2(x_2|l_2,s_2,m_2). \\] call probabilistic, can interpret individual dose-response curves, \\(h_i()\\) probability cell survival. Defining events \\[ \\begin{align} A_i & = \\text{cell survives drug concentration $x_{1i}$} \\\\ B_j & = \\text{cell survives drug B concentration $x_{2j}$} \\\\ C_{ij} & = \\text{cell survives drugs concentration $\\boldsymbol{x}=(x_{1i},x_{2j})$}, \\end{align} \\] corresponding probabilities become \\[ p_0(\\boldsymbol{x}) = P(C_{ij}) = P(A_i)P(B_i) = h_1(x_1|l_1,s_1,m_1) \\ h_2(x_2|l_2,s_2,m_2). \\]","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Model.html","id":"interaction","dir":"Articles","previous_headings":"The model","what":"Interaction","title":"Mathematical model","text":"interaction component, \\(\\Delta(\\boldsymbol{x})\\), captures joint effect drugs captured non-interaction assumption. two drugs effective together expected \\(p_0\\), call synergy, corresponds \\(\\Delta <0\\). opposite effect deemed antagonism. interaction landscape can complex, multiple local peaks valleys, model term non-parametrically using Gaussian Process prior (GP). ensure resulting dose-response function takes values interval \\((0,1)\\), push GP transformation function \\(g()\\). \\[ z(\\boldsymbol{x}) \\sim \\mathcal{GP}(0,\\kappa(\\boldsymbol{x},\\boldsymbol{x}')) \\\\ \\Delta(\\boldsymbol{x}) = g(z(\\boldsymbol{x})), \\] transformation function looks like \\[ g(z(\\boldsymbol{x})) = \\frac{-p_0(\\boldsymbol{x})}{1+\\exp\\left\\{b_1z(\\boldsymbol{x})+\\log\\left[\\frac{p_0(\\boldsymbol{x})}{1-p_0(\\boldsymbol{x})}\\right]\\right\\}} + \\frac{1-p_0(\\boldsymbol{x})}{1+\\exp\\left\\{-b_2z(\\boldsymbol{x})-\\log\\left[\\frac{p_0(\\boldsymbol{x})}{1-p_0(\\boldsymbol{x})}\\right]\\right\\}}. \\] addition ensuring proper bounds dose-response function, transformation feature \\(g(0)=0\\), corresponds priori assumption \\[ \\mathbb{E}\\left[f(\\boldsymbol{x}) | p_0(\\boldsymbol{x})\\right] \\approx p_0(\\boldsymbol{x}). \\] , make non-interaction assumption formal prior expectation dose-response function. achieves two things, (1) slightly conservative model needs convinced interaction effects present, (2) built-bias interaction prior structure. covariance function \\(\\kappa(\\boldsymbol{x},\\boldsymbol{x}')\\) can given multiple specifications, including squared exponential, Matérn, Rational Quadratic covariance functions. default, use Matérn covariance \\(\\nu\\) parameter set 3/2 yielding \\[ \\kappa(\\boldsymbol{x},\\boldsymbol{x}') = \\sigma_f^2\\left(1+\\frac{\\sqrt{3}\\Vert\\boldsymbol{x}-\\boldsymbol{x}'\\Vert}{\\ell}\\right)\\exp\\left\\{-\\frac{\\sqrt{3}\\Vert\\boldsymbol{x}-\\boldsymbol{x}'\\Vert}{\\ell}\\right\\}. \\] Finally, utilizing natural grid structure drug concentrations, can write kernel function \\[ \\kappa(\\boldsymbol{x},\\boldsymbol{x}') = \\sigma_f^2 \\kappa(x_1,x_1')\\kappa(x_2,x_2'), \\] induces Kronecker product structure final covariance matrix. Following implementation detailed Flaxman et al. (2015), greatly improves computational efficiency model.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Model.html","id":"the-observation-model","dir":"Articles","previous_headings":"The model","what":"The observation model","title":"Mathematical model","text":"Given formulation dose-response function \\(f\\), assume access noisy observations . observations typically generated various cellular assays, e.g. viability assays. particular assume given concentration points \\(\\boldsymbol{x}_1,\\ldots,\\boldsymbol{x}_n\\) observations \\(y_1,\\ldots,y_n\\) \\[ y_i = f(\\boldsymbol{x}_i) + \\epsilon_i, \\] assume errors \\(\\epsilon_i\\) normally distributed mean zero. variance observational errors, default model heteroscedastic fashion \\[ \\text{Var}\\left[\\epsilon_i\\right] = \\sigma^2(f(\\boldsymbol{x}_i)+\\lambda), \\] \\(\\lambda\\) set small value handle case \\(f = 0\\), still residual noise. typical setup cell viability calculated normalization positive negative controls, lambda can empirically set \\[ \\lambda = \\frac{\\sigma^2_{+}}{\\sigma^2_{-}}, \\] \\(\\sigma^2_{+}\\) \\(\\sigma^2_{-}\\) denotes variance positive negative controls, respectively. choose heteroscedastic model default, cell viability assays, observations normalized relation positive negative controls. positive controls typically much lower variance compared negative controls, translates viability measures closer zero precisely measured. also allow homoscedastic noise option.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Model.html","id":"full-model-specification","dir":"Articles","previous_headings":"The model","what":"Full model specification","title":"Mathematical model","text":"full model specification, default prior distributions look like \\[ y_i \\sim \\mathcal{N}\\left(f(\\boldsymbol{x}_i),\\sigma^2(f(\\boldsymbol{x}_i)+\\lambda)\\right), \\ = 1,\\ldots, n \\\\ \\sigma \\sim \\text{Inv-Ga}\\left(5,1\\right), \\ \\lambda = 0.005. \\\\ f(\\boldsymbol{x}_i) = p_0(\\boldsymbol{x}_i)+\\Delta(\\boldsymbol{x}_i) \\mathbb{}(10^{\\boldsymbol{x}_i}>0) \\\\ p_0(\\boldsymbol{x}) = h_1(x_1|l_1,s_1,m_1) \\ h_2(x_2|l_2,s_2,m_2). \\\\ l_j = \\text{Beta}(1,1.25), \\ s_i \\sim \\text{Gamma}(1,1), \\\\ m_i \\sim \\mathcal{N}(\\theta_i,\\sigma_{m_i}^2), \\ j = 1,2 \\\\ \\theta_i \\sim \\mathcal{N}(0,1), \\ \\sigma_{m_i}^2 \\sim \\text{Inv-Ga}\\left(3,2\\right), \\ j = 1,2 \\\\ \\Delta(\\boldsymbol{x}) = g(z(\\boldsymbol{x})), \\ z(\\boldsymbol{x}) \\sim \\mathcal{GP}(0,\\kappa(\\boldsymbol{x},\\boldsymbol{x}')) \\\\ g(z(\\boldsymbol{x})) = \\frac{-p_0(\\boldsymbol{x})}{1+\\exp\\left\\{b_1z(\\boldsymbol{x})+\\log\\left[\\frac{p_0(\\boldsymbol{x})}{1-p_0(\\boldsymbol{x})}\\right]\\right\\}} + \\frac{1-p_0(\\boldsymbol{x})}{1+\\exp\\left\\{-b_2z(\\boldsymbol{x})-\\log\\left[\\frac{p_0(\\boldsymbol{x})}{1-p_0(\\boldsymbol{x})}\\right]\\right\\}} \\\\ \\kappa(\\boldsymbol{x},\\boldsymbol{x}') = \\sigma_f^2\\left(1+\\frac{\\sqrt{3}\\Vert\\boldsymbol{x}-\\boldsymbol{x}'\\Vert}{\\ell}\\right)\\exp\\left\\{-\\frac{\\sqrt{3}\\Vert\\boldsymbol{x}-\\boldsymbol{x}'\\Vert}{\\ell}\\right\\}, \\\\ \\sigma_f^2 \\sim \\text{log-}\\mathcal{N}(1,1), \\ \\ell \\sim \\text{Inv-Ga}(5,5) \\\\ b_j \\sim \\mathcal{N}(1,0.1^2), \\ j = 1,2. \\] Note specifications can altered. example, default estimate lower asymptotes, can also fixed equal zero. model specification , interaction term multiplied indicator function \\(\\mathbb{}(\\boldsymbol{x}>0)\\) taking value 1 elements \\(\\boldsymbol{x}\\) strictly larger zero. makes sure don’t allow interaction one drugs zero concentration.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Model.html","id":"summary-measures","dir":"Articles","previous_headings":"The model","what":"Summary measures","title":"Mathematical model","text":"posterior dose-response function \\(f | \\mathbf{y}\\), derive number summary statistics concerning efficacy, synergy antagonism.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Model.html","id":"monotherapy-summaries","dir":"Articles","previous_headings":"The model > Summary measures","what":"Monotherapy summaries","title":"Mathematical model","text":"monotherapy curves, produce estimates drug sensitivity score (DSS) drug integral \\[ DSS_0 = \\int_a^b 1-h_j(x) \\text{d}x, \\] \\(=\\min(x_{1j})\\) \\(b=\\max(x_{1j})\\). , integral taken measured dose range drug question. contrast regular DSS score calculated, integration starts mono-therapy crosses 90% viability threshold. done better separate true effects background noise, since handled sampling, don’t need . DSS value standardized total volume available drug efficacy, \\[ DSS = \\frac{DSS_0}{(b-)} \\] , values can standardized Yadav et al. (2014).","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Model.html","id":"combination-summaries","dir":"Articles","previous_headings":"The model > Summary measures","what":"Combination summaries","title":"Mathematical model","text":"summarise combined drug-response function, utilise measures developed Cremaschi et al. (2019). basic building block ‘volume surface’ VUS, general integral looks like \\[ VUS_0(f) = \\int_a^b \\int_c^d f(\\mathbf{x}) \\ \\text{d}\\mathbf{x}, \\] integrals taken observed drug range, .e. \\(= \\min (x_1)\\), \\(b = \\max (x_1)\\), \\(c = \\min (x_2)\\), \\(d = \\max (x_2)\\). standardised obtain value zero 100, \\[ VUS(f) = \\frac{VUS_0(f)}{(b-)(d-c)}. \\] Furthermore, make overall measure efficacy, define residual VUS (rVUS) \\[ rVUS(f) = 100 - VUS(f), \\] makes value comparable DSS values, higher number now indicates larger efficacy drug combination. model calculates \\(rVUS\\) dose-response function \\(f\\), giving measure combined efficacy. addition, calculate \\(rVUS(p_0)\\), non-interaction efficacy. makes possible separate much total efficacy can attributed non-interaction assumption. interaction term, simply compute VUS values e.g. \\(VUS(\\Delta)\\) interaction efficacy. interaction term \\(\\Delta\\), also compute \\(VUS(\\Delta^{-})\\) \\(VUS(\\Delta^{+})\\) synergy antagonism, \\(\\Delta^{+}\\) \\(\\Delta^{-}\\) denotes positive negative parts \\(\\Delta\\), respectively. , \\[ \\Delta^{+}(\\mathbf{x}) = \\max(0,\\Delta(\\mathbf{x})) \\\\ \\Delta^{-}(\\mathbf{x}) = \\min(0,\\Delta(\\mathbf{x})). \\] compute measures , frequently, interaction surface contains antagonistic synergistic regions. taking average across whole surface, antagonistic outlier might cancel otherwise strong synergistic effect.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/Model.html","id":"summarising-large-screens","dir":"Articles","previous_headings":"The model > Summary measures","what":"Summarising large screens","title":"Mathematical model","text":"running screens large amount drug combinations, helpful normalised measure comparing synergy across experiments. \\(rVUS\\) scores defined already standardized drug concentration range, compare across experiments, also standardize respect uncertainty model. , calculate synergy score normalizing \\(rVUS(\\Delta^{-})\\) respect standard deviation. \\[ \\text{Synergy score} = \\frac{\\text{mean}(VUS(\\Delta^{-}))}{\\text{sd}(VUS(\\Delta^{-}))}. \\]","code":""},{"path":[]},{"path":"https://ocbe-uio.github.io/bayesynergy/articles/bayesynergy.html","id":"basic-usage-example","dir":"Articles","previous_headings":"","what":"Basic usage example","title":"Introduction to bayesynergy","text":"get started, simply load package included example dataset large drug combination screening experiment diffuse large B-cell lymphoma. access , simply run y contains measured post-treatment viability, x corresponding drug concentrations two drugs. fit model, simply run wait sampling process complete. results can plotted inspect model fit e.g. monotherapies  similarly full dose-response surface interactive figure Quantitative measures drug response synergy, alongside summaries model parameters can extracted running detailed look functionality package, please see vignettes.","code":"library(bayesynergy) data(\"mathews_DLBCL\") y <- mathews_DLBCL[[1]][[1]] x <- mathews_DLBCL[[1]][[2]] head(cbind(y,x)) ##      Viability ibrutinib ispinesib ## [1,] 1.2295618    0.0000         0 ## [2,] 1.0376006    0.1954         0 ## [3,] 1.1813851    0.7812         0 ## [4,] 0.5882688    3.1250         0 ## [5,] 0.4666700   12.5000         0 ## [6,] 0.2869514   50.0000         0 fit <- bayesynergy(y,x) plot(fit) summary(fit) ##                 mean  se_mean     sd      2.5%       50%  97.5% n_eff  Rhat ## la_1[1]       0.3343 0.001788 0.0747  1.51e-01  3.44e-01  0.458  1745 1.001 ## la_2[1]       0.3819 0.005848 0.0783  4.38e-02  3.96e-01  0.457   179 1.030 ## log10_ec50_1  0.4789 0.003778 0.1540  2.47e-01  4.44e-01  0.861  1661 1.001 ## log10_ec50_2 -1.0174 0.019796 1.0126 -3.31e+00 -8.89e-01  0.496  2617 1.002 ## slope_1       2.0387 0.018252 0.9185  8.66e-01  1.83e+00  4.272  2533 1.000 ## slope_2       1.4655 0.025171 1.0893  7.02e-02  1.21e+00  4.218  1873 1.002 ## ell           3.0709 0.031257 1.4521  1.24e+00  2.77e+00  6.781  2158 1.000 ## sigma_f       0.8380 0.014826 0.7508  1.65e-01  6.20e-01  2.800  2565 1.000 ## s             0.0963 0.000255 0.0144  7.27e-02  9.46e-02  0.130  3197 0.999 ## dss_1        33.5248 0.043088 2.8793  2.79e+01  3.36e+01 39.201  4465 1.000 ## dss_2        59.4251 0.042181 2.8459  5.36e+01  5.95e+01 64.733  4552 1.001 ## rVUS_f       82.7673 0.012841 0.8353  8.11e+01  8.28e+01 84.343  4231 1.000 ## rVUS_p0      73.0501 0.033638 2.2203  6.85e+01  7.31e+01 77.198  4357 1.001 ## VUS_Delta    -9.7172 0.037290 2.3946 -1.45e+01 -9.65e+00 -5.286  4124 1.001 ## VUS_syn      -9.7632 0.036838 2.3534 -1.45e+01 -9.68e+00 -5.478  4081 1.001 ## VUS_ant       0.0461 0.001896 0.1074  4.64e-06  8.13e-05  0.365  3206 1.000 ##  ## log-Pseudo Marginal Likelihood (LPML) =  52.23965"},{"path":"https://ocbe-uio.github.io/bayesynergy/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Leiv Rønneberg. Author, maintainer. Andrea Cremaschi. Author. Robert Hanes. Author. Chi Zhang. Author. Manuela Zucknick. Author.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Rønneberg L, Cremaschi , Hanes R, Zhang C, Zucknick M (2023). bayesynergy: Bayesian semi-parametric modelling -vitro drug combination experiments. R package version 2.5.1, https://ocbe-uio.github.io/bayesynergy/.","code":"@Manual{,   title = {bayesynergy: Bayesian semi-parametric modelling for in-vitro drug combination experiments},   author = {Leiv Rønneberg and Andrea Cremaschi and Robert Hanes and Chi Zhang and Manuela Zucknick},   year = {2023},   note = {R package version 2.5.1},   url = {https://ocbe-uio.github.io/bayesynergy/}, }"},{"path":"https://ocbe-uio.github.io/bayesynergy/index.html","id":"bayesynergy-flexible-bayesian-modelling-of-synergistic-interaction-effects-in-in-vitro-drug-combination-experiments","dir":"","previous_headings":"","what":"Bayesian semi-parametric modelling for in-vitro drug combination experiments","title":"Bayesian semi-parametric modelling for in-vitro drug combination experiments","text":"R package Bayesian semi-parametric modelling -vitro drug combination experiments   bayesynergy package implements Bayesian semi-parametric model drug combination experiment. efficient implementation Stan, model provides estimates full dose-response surface uncertainty quantification. posterior dose-response function, estimates synergy antagonism derived better reflect true uncertainty estimates. model handles incomplete messy datasets, naturally includes replicates, contains parallel processing large drug combination screens. Paper","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian semi-parametric modelling for in-vitro drug combination experiments","text":"Prior installing package, please install RStan, make sure can run models . Stan requires configuration C++ toolchain, can tricky systems. Note macOS, XQuartz must installed plotting functions work properly.","code":"install.packages('devtools') library(devtools) install_github('ocbe-uio/bayesynergy', build_vignettes = T, build_opts = c(\"--no-resave-data\", \"--no-manual\"))"},{"path":"https://ocbe-uio.github.io/bayesynergy/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Bayesian semi-parametric modelling for in-vitro drug combination experiments","text":"Leiv Rønneberg, Andrea Cremaschi, Robert Hanes, Jorrit M Enserink, Manuela Zucknick, bayesynergy: flexible Bayesian modelling synergistic interaction effects vitro drug combination experiments, Briefings Bioinformatics, Volume 22, Issue 6, November 2021, bbab251, https://doi.org/10.1093/bib/bbab251","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/index.html","id":"updates","dir":"","previous_headings":"","what":"Updates","title":"Bayesian semi-parametric modelling for in-vitro drug combination experiments","text":"29-09-22: Updated version 2.5. Added new ‘robust’ likelihood, less sensitive outliers, particularly combined new penalized complexity (PC) prior Matérn kernel hyperparameters. Finally, changed default prior global noise term Inverse-gamma, half-Cauchy. 26-05-21: Updated version 2.4.1, minor notation changes. Ability calculate Bayes Factor comparing models without interaction 29-03-21: Updated version 2.4, minor tweaks priors, default settings plotting function. Added option set hyperparameters observation noise 13-01-21: Updated version 2.3, added new dataset use synergyscreen(), fixed bug synergyscreen() filling hard drive, added vignette 01-12-20: Updated version 2.2, added additional plotting functions synergyscreen() function, added heteroscedastic setting noise term, + minor improvements overall. 14-10-20: Updated version 2.1, removed Gibbs sampler, now compile easier Windows systems 27-08-20: Updated version 2.0, now running Stan! 03-03-20: Added support missing values! 14-04-20: Added option estimate lower asymptotes monotherapies","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/BayeSyneRgy.html","id":null,"dir":"Reference","previous_headings":"","what":"bayesynergy — bayesynergy","title":"bayesynergy — bayesynergy","text":"function bayesynergy main function bayesynergy package. fit Bayesian semi-parametric model -vitro drug combination experiments estimate synergistic antagonistic effects.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/BayeSyneRgy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"bayesynergy — bayesynergy","text":"","code":"bayesynergy(   y,   x,   type = 3,   drug_names = NULL,   experiment_ID = NULL,   units = NULL,   lower_asymptotes = T,   heteroscedastic = T,   bayes_factor = F,   robust = F,   rho = 0.9,   pcprior = F,   pcprior_hypers = c(1, 0.1, 1, 0.2),   lambda = 0.005,   nu = 1.5,   method = \"sampling\",   control = list(),   ... )"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/BayeSyneRgy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"bayesynergy — bayesynergy","text":"y vector matrix viability measures. Replicates can given long wide format. x two-column matrix drug concentrations. type integer; type model used. Must one following: 1 (Splines), 2 (GP squared exponential kernel), 3 (GP Matérn kernel) 4 (GP rational quadratic kernel). drug_names vector size 2; names drugs utilized experiment. experiment_ID character; identifier experiment, typically name cell Line. units vector size 2; concentration units drugs, e.g. c(\"\\(\\mu\\)M\",\"\\(\\mu\\)M\") lower_asymptotes logical; TRUE model estimate lower asymptotes monotherapy curves. heteroscedastic logical; TRUE, model assume heteroscedastic measurement error. bayes_factor logical; TRUE, Bayes factor computed full model, model containing non-interaction surface. robust logical: TRUE, model assumes log-Pareto-tailed Normal (LPTN) distribution rho numeric: rho hyperparameter robust likelihood distribution pcprior logical: TRUE, model uses penalized complexity (PC) prior kernel hyperparameters Matérn kernel (type=3) pcprior_hypers vector size 4 giving hyperparameters PC prior Matérn hyperparameters lambda numeric; parameter controls residual noise observed heteroscedastic model f = 0. nu numeric; nu parameter Matérn kernel. Must one (0.5, 1.5, 2.5) method method estimation. Must one `sampling`,`vb` corresponding full sampling, variational Bayes. control list; passed stan sampler, e.g. setting adapt_delta. ... Arguments passed rstan::sampling rstan::vb (e.g. iter, chains).","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/BayeSyneRgy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"bayesynergy — bayesynergy","text":"object S3 class \"bayesynergy\", list following entries","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/BayeSyneRgy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"bayesynergy — bayesynergy","text":"","code":"if (FALSE) { library(bayesynergy) data(\"mathews_DLBCL\") y_mat <- mathews_DLBCL$`ispinesib + ibrutinib`[[1]] x_mat <- mathews_DLBCL$`ispinesib + ibrutinib`[[2]] fit <- bayesynergy(y_mat,x_mat) }"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/ONeil_A375.html","id":null,"dir":"Reference","previous_headings":"","what":"A drug combination dataset — ONeil_A375","title":"A drug combination dataset — ONeil_A375","text":"example dataset large drug combination screening experiment, -375 human melanoma cell line.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/ONeil_A375.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A drug combination dataset — ONeil_A375","text":"","code":"data(ONeil_A375)"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/ONeil_A375.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A drug combination dataset — ONeil_A375","text":"synergyscreen object, consisting initial run 583 drug combinations -375 human melanoma cell line. Contains dataframe summary statistics 581 experiments, list containing two experiments failed process.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/ONeil_A375.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A drug combination dataset — ONeil_A375","text":"O'Neil J, Benita Y, Feldman , Chenard M, Roberts B, Liu Y, Li J, Kral , Lejnine S, Loboda , Arthur W, Cristescu R, Haines BB, Winter C, Zhang T, Bloecher , Shumway SD. Unbiased Oncology Compound Screen Identify Novel Combination Strategies. Mol Cancer Ther. 2016 Jun;15(6):1155-62. doi: 10.1158/1535-7163.MCT-15-0843. Epub 2016 Mar 16. PMID: 26983881.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/mathews_DLBCL.html","id":null,"dir":"Reference","previous_headings":"","what":"A drug combination dataset — mathews_DLBCL","title":"A drug combination dataset — mathews_DLBCL","text":"example dataset large drug combination screening experiment, treatment diffuse large B-cell lymphoma.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/mathews_DLBCL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A drug combination dataset — mathews_DLBCL","text":"","code":"data(mathews_DLBCL)"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/mathews_DLBCL.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A drug combination dataset — mathews_DLBCL","text":"list containing two distinct dataset experiment. list element list two elemnts: matrix viability scores, matrix corresponding concentrations. data adapted data provided synergyfinder R package.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/mathews_DLBCL.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A drug combination dataset — mathews_DLBCL","text":"Mathews Griner LA, Guha R, Shinn P, et al. High-throughput combinatorial screening identifies drugs cooperate ibrutinib kill activated B-cell-like diffuse large B-cell lymphoma cells. Proc Natl Acad Sci U S . 2014;111(6):2349–2354. L, Kulesskiy E, Saarela J, Turunen L, Wennerberg K, Aittokallio T, et al. (2018) Methods High-throughput Drug Combination Screening Synergy Scoring. : von Stechow L, editor. Cancer Systems Biology: Methods Protocols. New York, NY: Springer New York. P351-98.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/plot.bayesynergy.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot function for a bayesynergy object — plot.bayesynergy","title":"Plot function for a bayesynergy object — plot.bayesynergy","text":"function plotting synergy surfaces summary statistics bayesynergy object.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/plot.bayesynergy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot function for a bayesynergy object — plot.bayesynergy","text":"","code":"# S3 method for bayesynergy plot(x, plot3D = T, save_plots = FALSE, path = NULL, plotdevice = \"pdf\", ...)"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/plot.bayesynergy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot function for a bayesynergy object — plot.bayesynergy","text":"x object class bayesynergy, result bayesynergy. plot3D logical; TRUE, interactive 3D surface plots dose response function displayed. save_plots logical; TRUE plots saved locally. path string; path saving plots, NULL defaults work directory. plotdevice string; device saving plots locally, must 'pdf' 'png' ... arguments passed device plotting, useful setting width height saved plots.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/plot.bayesynergy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot function for a bayesynergy object — plot.bayesynergy","text":"function extends plot draw response interaction surfaces fitted model. three-dimensional interactive plots, two-dimensional contour plots can displayed.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/plot.bayesynergy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot function for a bayesynergy object — plot.bayesynergy","text":"","code":"if (FALSE) { library(bayesynergy) data(\"mathews_DLBCL\") y_mat <- mathews_DLBCL$`ispinesib + ibrutinib`[[1]] x_mat <- mathews_DLBCL$`ispinesib + ibrutinib`[[2]] fit <- bayesynergy(y_mat,x_mat) plot(fit) }"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/plot.synergyscreen.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot function for a synergyscreen object — plot.synergyscreen","title":"Plot function for a synergyscreen object — plot.synergyscreen","text":"function plotting summary statistics synergyscreen object.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/plot.synergyscreen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot function for a synergyscreen object — plot.synergyscreen","text":"","code":"# S3 method for synergyscreen plot(   x,   groupbyExperimentID = T,   save_plots = FALSE,   path = NULL,   plotdevice = \"pdf\",   ... )"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/plot.synergyscreen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot function for a synergyscreen object — plot.synergyscreen","text":"x object class synergyscreen, result synergyscreen. groupbyExperimentID logical; TRUE, individual plots produced per experiment ID. save_plots logical; TRUE plots saved locally. path string; path saving plots, NULL defaults work directory. plotdevice string; device saving plots locally, must 'pdf' 'png' ... arguments passed device plotting, useful setting width height saved plots.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/plot.synergyscreen.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot function for a synergyscreen object — plot.synergyscreen","text":"function extends plot summarize results large screens.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/plot.synergyscreen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot function for a synergyscreen object — plot.synergyscreen","text":"","code":"if (FALSE) { library(bayesynergy) data(\"mathews_DLBCL\") experiment1 = list(y = mathews_DLBCL[[1]][[1]], x = mathews_DLBCL[[1]][[2]], drug_names = c(\"ispinesib\",\"ibrutinib\")) experiment2 = list(y = mathews_DLBCL[[2]][[1]], x = mathews_DLBCL[[2]][[2]], drug_names = c(\"canertinib\",\"ibrutinib\")) experiments = list(experiment1,experiment2) fit <- synergyscreen(experiments) plot(fit) }"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/summary.bayesynergy.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary function for bayesynergy object — summary.bayesynergy","title":"Summary function for bayesynergy object — summary.bayesynergy","text":"function summarizing posterior inference bayesynergy object.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/summary.bayesynergy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary function for bayesynergy object — summary.bayesynergy","text":"","code":"# S3 method for bayesynergy summary(object, ...)"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/summary.bayesynergy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary function for bayesynergy object — summary.bayesynergy","text":"object fitted model summarise, bayesynergy. ... arguments passed methods.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/summary.bayesynergy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary function for bayesynergy object — summary.bayesynergy","text":"","code":"if (FALSE) { library(bayesynergy) data(\"mathews_DLBCL\") y_mat <- mathews_DLBCL$`ispinesib + ibrutinib`[[1]] x_mat <- mathews_DLBCL$`ispinesib + ibrutinib`[[2]] fit <- bayesynergy(y_mat,x_mat) summary(fit) }"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/synergyscreen.html","id":null,"dir":"Reference","previous_headings":"","what":"Function for fitting high-througput drug combination screens with parallel processing — synergyscreen","title":"Function for fitting high-througput drug combination screens with parallel processing — synergyscreen","text":"function synergyscreen allows fitting high-throughput drug combination screens parallel processing","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/synergyscreen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function for fitting high-througput drug combination screens with parallel processing — synergyscreen","text":"","code":"synergyscreen(   experiments,   return_samples = F,   save_raw = T,   save_plots = T,   path = NULL,   parallel = T,   max_cores = NULL,   max_retries = 3,   plot_params = list(),   bayesynergy_params = list() )"},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/synergyscreen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function for fitting high-througput drug combination screens with parallel processing — synergyscreen","text":"experiments list experiments obtained high-throughput screen. See *Details* information structure element. return_samples logical; TRUE, function returns full fitted bayesynergy object. save_raw logical; TRUE, raw bayesynergy object saved individual experiment. save_plots logical; TRUE, plots individual experiment saved. path string; path saving output plot individual experiment. parallel logical; TRUE, parallel processing utilized run screen. max_cores integer; maximum number cores utilize parallel processing. max_retries integer; maximum number retries utilized model fit. plot_params list; parameters passed plotting function. See plot.bayesynergy details. bayesynergy_params list; parameters passed bayesynergy function. See bayesynergy details.","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/synergyscreen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function for fitting high-througput drug combination screens with parallel processing — synergyscreen","text":"list containing two elements","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/synergyscreen.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function for fitting high-througput drug combination screens with parallel processing — synergyscreen","text":"elements experiments must lists following elements","code":""},{"path":"https://ocbe-uio.github.io/bayesynergy/reference/synergyscreen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function for fitting high-througput drug combination screens with parallel processing — synergyscreen","text":"","code":"if (FALSE) { library(bayesynergy) data(\"mathews_DLBCL\") experiment1 = list(y = mathews_DLBCL[[1]][[1]], x = mathews_DLBCL[[1]][[2]], drug_names = c(\"ispinesib\",\"ibrutinib\")) experiment2 = list(y = mathews_DLBCL[[2]][[1]], x = mathews_DLBCL[[2]][[2]], drug_names = c(\"canertinib\",\"ibrutinib\")) experiments = list(experiment1,experiment2) fit <- synergyscreen(experiments) }"}]
