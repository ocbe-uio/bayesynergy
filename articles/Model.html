<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bayesynergy">
<title>Model • bayesynergy</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model">
<meta property="og:description" content="bayesynergy">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bayesynergy</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.5.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/bayesynergy.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Diagonsis_and_robustness.html">Diagnosis, warnings and robustness</a>
    <a class="dropdown-item" href="../articles/Model.html">Model</a>
    <a class="dropdown-item" href="../articles/Single_experiement.html">Single experiment example</a>
    <a class="dropdown-item" href="../articles/Synergy_screen.html">Synergy screen example</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Model</h1>
                        <h4 data-toc-skip class="author">Leiv
Rønneberg</h4>
            
            <h4 data-toc-skip class="date">05/09/2022</h4>
      
      
      <div class="d-none name"><code>Model.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="the-model">The model<a class="anchor" aria-label="anchor" href="#the-model"></a>
</h2>
<p>The <strong>dose-response</strong> function <span class="math inline">\(f:\boldsymbol{x} \to (0,1)\)</span>, maps drug
concentrations <span class="math inline">\(\boldsymbol{x}\)</span> to a
measure of cell viability – zero corresponding to all cells being dead
after treatment, one corresponding to all cells still alive. In
drug-combination screens, it is common to assume that the dose-response
function can be broken down as <span class="math display">\[
f(\boldsymbol{x}) = p_0(\boldsymbol{x})+\Delta(\boldsymbol{x}),
\]</span> where <span class="math inline">\(p_0(\boldsymbol{x})\)</span>
encodes a <em>non-interaction assumption</em>, and <span class="math inline">\(\Delta(\boldsymbol{x})\)</span> captures the
residual interaction effect.</p>
<div class="section level3">
<h3 id="non-interaction">Non-interaction<a class="anchor" aria-label="anchor" href="#non-interaction"></a>
</h3>
<p>The non-interaction assumption, <span class="math inline">\(p_0(\boldsymbol{x})\)</span>, captures what can be
reasonably assumed about a joint drug effect, given estimates of the
drugs’ individual effect. We assume a Bliss style independence
assumption, where we first assume that the individual drugs’
dose-response function takes the form of a log-logistic curve <span class="math display">\[
h_i(x_i|l,s,m) = l + \frac{1-l}{1+10^{s(x_i-m)}},
\]</span> where <span class="math inline">\(l\)</span> is the
lower-asymptote, <span class="math inline">\(s\)</span> the slope, and
<span class="math inline">\(m\)</span> the drugs ‘EC-50’ on the <span class="math inline">\(\log_{10}\)</span> scale. The Bliss assumption
then amounts to a probabilistic independence assumption, where <span class="math display">\[
p_0(\boldsymbol{x}) = h_1(x_1|l_1,s_1,m_1) \ h_2(x_2|l_2,s_2,m_2).
\]</span> We call it probabilistic, because we can interpret the
individual dose-response curves, <span class="math inline">\(h_i()\)</span> as probability of cell survival.
Defining the events <span class="math display">\[
\begin{align}
A_i &amp; = \text{A cell survives drug A at concentration $x_{1i}$} \\
B_j &amp; = \text{A cell survives drug B at concentration $x_{2j}$} \\
C_{ij} &amp; = \text{A cell survives both drugs at concentration
$\boldsymbol{x}=(x_{1i},x_{2j})$},
\end{align}
\]</span> the corresponding probabilities become <span class="math display">\[
p_0(\boldsymbol{x}) = P(C_{ij}) = P(A_i)P(B_i) = h_1(x_1|l_1,s_1,m_1) \
h_2(x_2|l_2,s_2,m_2).
\]</span></p>
</div>
<div class="section level3">
<h3 id="interaction">Interaction<a class="anchor" aria-label="anchor" href="#interaction"></a>
</h3>
<p>The interaction component, <span class="math inline">\(\Delta(\boldsymbol{x})\)</span>, captures any
joint effect of the drugs that is not captured by the non-interaction
assumption. If two drugs are more effective together than it would be
expected by <span class="math inline">\(p_0\)</span>, we call it
<em>synergy</em>, which corresponds to <span class="math inline">\(\Delta &lt;0\)</span>. The opposite effect is
deemed <em>antagonism</em>.</p>
<p>Because the interaction landscape can be complex, with multiple local
peaks and valleys, we model this term non-parametrically using a
Gaussian Process prior (GP). To ensure that the resulting dose-response
function only takes values in the interval <span class="math inline">\((0,1)\)</span>, we push the GP through a
transformation function <span class="math inline">\(g()\)</span>. That
is <span class="math display">\[
z(\boldsymbol{x}) \sim
\mathcal{GP}(0,\kappa(\boldsymbol{x},\boldsymbol{x}')) \\
\Delta(\boldsymbol{x}) = g(z(\boldsymbol{x})),
\]</span> where the transformation function looks like <span class="math display">\[
g(z(\boldsymbol{x})) =
\frac{-p_0(\boldsymbol{x})}{1+\exp\left\{b_1z(\boldsymbol{x})+\log\left[\frac{p_0(\boldsymbol{x})}{1-p_0(\boldsymbol{x})}\right]\right\}}
+
\frac{1-p_0(\boldsymbol{x})}{1+\exp\left\{-b_2z(\boldsymbol{x})-\log\left[\frac{p_0(\boldsymbol{x})}{1-p_0(\boldsymbol{x})}\right]\right\}}.
\]</span> In addition to ensuring the proper bounds for the
dose-response function, this transformation has the feature of <span class="math inline">\(g(0)=0\)</span>, which corresponds to an <em>a
priori</em> assumption that <span class="math display">\[
\mathbb{E}\left[f(\boldsymbol{x}) | p_0(\boldsymbol{x})\right] \approx
p_0(\boldsymbol{x}).
\]</span> That is, we make our non-interaction assumption into a formal
prior expectation on the dose-response function. This achieves two
things, (1) a slightly conservative model that needs to be convinced
that interaction effects are present, and (2) no built-in bias of
interaction in the prior structure.</p>
<p>The covariance function <span class="math inline">\(\kappa(\boldsymbol{x},\boldsymbol{x}')\)</span>
can be given multiple specifications, including a squared exponential,
Matérn, and Rational Quadratic covariance functions. By default, we use
a Matérn covariance with the <span class="math inline">\(\nu\)</span>
parameter set to 3/2 yielding <span class="math display">\[
\kappa(\boldsymbol{x},\boldsymbol{x}') =
\sigma_f^2\left(1+\frac{\sqrt{3}\Vert\boldsymbol{x}-\boldsymbol{x}'\Vert}{\ell}\right)\exp\left\{-\frac{\sqrt{3}\Vert\boldsymbol{x}-\boldsymbol{x}'\Vert}{\ell}\right\}.
\]</span> Finally, by utilizing the natural grid structure of the drug
concentrations, we can write the kernel function as <span class="math display">\[
\kappa(\boldsymbol{x},\boldsymbol{x}') = \sigma_f^2
\kappa(x_1,x_1')\kappa(x_2,x_2'),
\]</span> which induces a Kronecker product structure on the final
covariance matrix. Following the implementation detailed in <span class="citation">Flaxman et al. (2015)</span>, this greatly improves the
computational efficiency of the model.</p>
</div>
<div class="section level3">
<h3 id="the-observation-model">The observation model<a class="anchor" aria-label="anchor" href="#the-observation-model"></a>
</h3>
<p>Given the above formulation for the dose-response function <span class="math inline">\(f\)</span>, we assume that we have access to noisy
observations from it. These observations are typically generated from
various cellular assays, e.g. viability assays. In particular we assume
that given concentration points <span class="math inline">\(\boldsymbol{x}_1,\ldots,\boldsymbol{x}_n\)</span>
we have observations <span class="math inline">\(y_1,\ldots,y_n\)</span>
where <span class="math display">\[
y_i = f(\boldsymbol{x}_i) + \epsilon_i,
\]</span> where we assume that the errors <span class="math inline">\(\epsilon_i\)</span> are normally distributed with
mean zero. For the variance of the observational errors, by default we
model these in a heteroscedastic fashion as <span class="math display">\[
\text{Var}\left[\epsilon_i\right] =
\sigma^2(f(\boldsymbol{x}_i)+\lambda),
\]</span> where <span class="math inline">\(\lambda\)</span> is set to a
small value to handle the case when <span class="math inline">\(f =
0\)</span>, but there is still some residual noise. In a typical setup
where cell viability is calculated through a normalization to positive
and negative controls, lambda can be empirically set as <span class="math display">\[
\lambda = \frac{\sigma^2_{+}}{\sigma^2_{-}},
\]</span> where <span class="math inline">\(\sigma^2_{+}\)</span> and
<span class="math inline">\(\sigma^2_{-}\)</span> denotes the variance
of positive and negative controls, respectively.</p>
<p>We choose a heteroscedastic model by default, because in cell
viability assays, the observations are normalized in relation to
positive and negative controls. The positive controls typically have
much lower variance compared to the negative controls, which translates
to viability measures closer to zero being more precisely measured. We
also allow homoscedastic noise as an option.</p>
<div class="section level4">
<h4 id="including-controls">Including controls<a class="anchor" aria-label="anchor" href="#including-controls"></a>
</h4>
<p>The positive and negative controls essentially control the
signal-to-noise ratio in cell viability assays. If the user has access
to these, they can be included in the model to help calibrate the
posterior distribution – particularly in the case with zero
replicates.</p>
<p>Let <span class="math inline">\(\xi^-_k\)</span> and <span class="math inline">\(\xi^+_l\)</span> denote the negative and positive
controls for <span class="math inline">\(k=1,\ldots,n_-\)</span> and
<span class="math inline">\(l=1,\ldots,n_+\)</span>. These measurements
are raw readings from the plate and are used to calculate cell
viability. For an additional well, treated with drug concentration <span class="math inline">\(\mathbf{x}_i\)</span>, we denote the raw output by
<span class="math inline">\(\xi_i\)</span>, and calculate cell viability
for this well by the formula: <span class="math display">\[
y_i = \frac{\xi_i-\tilde{\xi^+}}{\tilde{\xi^-}-\tilde{\xi^+}},
\]</span> where <span class="math inline">\(\tilde{\xi^-}\)</span> and
<span class="math inline">\(\tilde{\xi^+}\)</span> denotes some measure
of centrality of the positive and negative controls, typically the mean
or median.</p>
<p>The controls can themselves be passed through this function and
converted to % viability. From the variances of these normalized
controls, <span class="math inline">\(\lambda\)</span> can be set as
indicated above. And the negative controls can be added directly into
the algorithm. Negative controls represents unhindered cell growth, and
can be thought of as samples from the dose-response function <span class="math inline">\(f(\mathbf{x})\)</span> at concentration <span class="math inline">\(\mathbf{x}=(0,0)\)</span>. These can then be added
directly to the <span class="math inline">\(\texttt{bayesynergy}\)</span> function in the same
way as regular observations.</p>
</div>
</div>
<div class="section level3">
<h3 id="full-model-specification">Full model specification<a class="anchor" aria-label="anchor" href="#full-model-specification"></a>
</h3>
<p>The full model specification, with all default prior distributions
look like <span class="math display">\[
y_i \sim
\mathcal{N}\left(f(\boldsymbol{x}_i),\sigma^2(f(\boldsymbol{x}_i)+\lambda)\right),
\ i = 1,\ldots, n \\
\sigma \sim \text{Inv-Ga}\left(5,1\right), \ \lambda = 0.005. \\
f(\boldsymbol{x}_i) = p_0(\boldsymbol{x}_i)+\Delta(\boldsymbol{x}_i)
\mathbb{I}(10^{\boldsymbol{x}_i}&gt;0) \\
p_0(\boldsymbol{x}) = h_1(x_1|l_1,s_1,m_1) \ h_2(x_2|l_2,s_2,m_2). \\
l_j = \text{Beta}(1,1.25), \ s_i \sim \text{Gamma}(1,1), \\
m_i \sim \mathcal{N}(\theta_i,\sigma_{m_i}^2), \ j = 1,2 \\
\theta_i \sim \mathcal{N}(0,1), \ \sigma_{m_i}^2 \sim
\text{Inv-Ga}\left(3,2\right), \ j = 1,2 \\
\Delta(\boldsymbol{x}) = g(z(\boldsymbol{x})), \ z(\boldsymbol{x}) \sim
\mathcal{GP}(0,\kappa(\boldsymbol{x},\boldsymbol{x}')) \\
g(z(\boldsymbol{x})) =
\frac{-p_0(\boldsymbol{x})}{1+\exp\left\{b_1z(\boldsymbol{x})+\log\left[\frac{p_0(\boldsymbol{x})}{1-p_0(\boldsymbol{x})}\right]\right\}}
+
\frac{1-p_0(\boldsymbol{x})}{1+\exp\left\{-b_2z(\boldsymbol{x})-\log\left[\frac{p_0(\boldsymbol{x})}{1-p_0(\boldsymbol{x})}\right]\right\}}
\\
\kappa(\boldsymbol{x},\boldsymbol{x}') =
\sigma_f^2\left(1+\frac{\sqrt{3}\Vert\boldsymbol{x}-\boldsymbol{x}'\Vert}{\ell}\right)\exp\left\{-\frac{\sqrt{3}\Vert\boldsymbol{x}-\boldsymbol{x}'\Vert}{\ell}\right\},
\\
\sigma_f^2 \sim \text{log-}\mathcal{N}(1,1), \ \ell \sim
\text{Inv-Ga}(5,5) \\
b_j \sim \mathcal{N}(1,0.1^2), \ j = 1,2.
\]</span> Note that some of these specifications can be altered. For
example, by default we estimate the lower asymptotes, but they can also
be fixed equal to zero.</p>
<p>In the model specification above, the interaction term is multiplied
with an indicator function <span class="math inline">\(\mathbb{I}(\boldsymbol{x}&gt;0)\)</span> taking
the value 1 if and only if all elements in <span class="math inline">\(\boldsymbol{x}\)</span> is strictly larger than
zero. This makes sure that we don’t allow for interaction when one of
the drugs is at zero concentration.</p>
</div>
<div class="section level3">
<h3 id="summary-measures">Summary measures<a class="anchor" aria-label="anchor" href="#summary-measures"></a>
</h3>
<p>From the posterior dose-response function <span class="math inline">\(f | \mathbf{y}\)</span>, we derive a number of
summary statistics concerning efficacy, synergy and antagonism.</p>
<div class="section level4">
<h4 id="monotherapy-summaries">Monotherapy summaries<a class="anchor" aria-label="anchor" href="#monotherapy-summaries"></a>
</h4>
<p>For the monotherapy curves, we produce estimates of the drug
sensitivity score (DSS) of each drug by the integral</p>
<p><span class="math display">\[
DSS_0 = \int_a^b 1-h_j(x) \text{d}x,
\]</span> where <span class="math inline">\(a=\min(x_{1j})\)</span> and
<span class="math inline">\(b=\max(x_{1j})\)</span>. That is, the
integral is taken from the measured dose range of the drug in question.
This is in contrast to how the regular DSS score is calculated, where
integration starts where the mono-therapy crosses the 90% viability
threshold. This is done to better separate true effects from background
noise, but since this is handled here through sampling, we don’t need
it. The DSS value is further standardized by the total volume available
for drug efficacy, <span class="math display">\[
DSS = \frac{DSS_0}{(b-a)}
\]</span> From here, values can be further standardized as in <span class="citation">Yadav et al. (2014)</span>.</p>
</div>
<div class="section level4">
<h4 id="combination-summaries">Combination summaries<a class="anchor" aria-label="anchor" href="#combination-summaries"></a>
</h4>
<p>To summarise the combined drug-response function, we utilise the
measures developed in <span class="citation">Cremaschi et al.
(2019)</span>. The basic building block is the ‘volume under the
surface’ or <strong>VUS</strong>, for which the general integral looks
like</p>
<p><span class="math display">\[
VUS_0(f) = \int_a^b \int_c^d f(\mathbf{x}) \ \text{d}\mathbf{x},
\]</span> and the integrals are taken over the observed drug range, i.e.
<span class="math inline">\(a = \min (x_1)\)</span>, <span class="math inline">\(b = \max (x_1)\)</span>, <span class="math inline">\(c = \min (x_2)\)</span>, <span class="math inline">\(d = \max (x_2)\)</span>. This is then standardised
to obtain a value between zero and 100, <span class="math display">\[
VUS(f) = \frac{VUS_0(f)}{(b-a)(d-c)}.
\]</span> Furthermore, to make this into an overall measure of efficacy,
we define the <em>residual</em> VUS (<strong>rVUS</strong>) by</p>
<p><span class="math display">\[
rVUS(f) = 100 - VUS(f),
\]</span> which makes this value more comparable with the DSS values,
where a higher number now indicates a larger efficacy of the drug
combination.</p>
<p>The model calculates <span class="math inline">\(rVUS\)</span> for
the dose-response function <span class="math inline">\(f\)</span>,
giving a measure of combined efficacy. In addition, we calculate <span class="math inline">\(rVUS(p_0)\)</span>, the non-interaction efficacy.
This makes it possible to separate how much of the total efficacy that
can be attributed to the non-interaction assumption. For the interaction
term, we simply compute the <strong>VUS</strong> values e.g. <span class="math inline">\(VUS(\Delta)\)</span> for the interaction efficacy.
For the interaction term <span class="math inline">\(\Delta\)</span>, we
also compute <span class="math inline">\(VUS(\Delta^{-})\)</span> and
<span class="math inline">\(VUS(\Delta^{+})\)</span> for synergy and
antagonism, where <span class="math inline">\(\Delta^{+}\)</span> and
<span class="math inline">\(\Delta^{-}\)</span> denotes the positive and
negative parts of <span class="math inline">\(\Delta\)</span>,
respectively. That is,</p>
<p><span class="math display">\[
\Delta^{+}(\mathbf{x}) = \max(0,\Delta(\mathbf{x})) \\
\Delta^{-}(\mathbf{x}) = \min(0,\Delta(\mathbf{x})).
\]</span> We compute these measures because, frequently, the interaction
surface contains both antagonistic and synergistic regions. When taking
the average across the whole surface, an antagonistic outlier might
cancel an otherwise strong synergistic effect.</p>
</div>
<div class="section level4">
<h4 id="summarising-large-screens">Summarising large screens<a class="anchor" aria-label="anchor" href="#summarising-large-screens"></a>
</h4>
<p>When running screens with a large amount of drug combinations, it is
helpful to have a normalised measure for comparing synergy across
experiments. The <span class="math inline">\(rVUS\)</span> scores
defined above are already standardized to their drug concentration
range, but to compare across experiments, we also standardize with
respect to the uncertainty in the model. To do this, we calculate a
<strong>synergy score</strong> by normalizing <span class="math inline">\(rVUS(\Delta^{-})\)</span> with respect to its
standard deviation. <span class="math display">\[
\text{Synergy score} =
\frac{\text{mean}(VUS(\Delta^{-}))}{\text{sd}(VUS(\Delta^{-}))}.
\]</span></p>
</div>
</div>
<div class="section level3">
<h3 id="synergy-classification">Synergy classification<a class="anchor" aria-label="anchor" href="#synergy-classification"></a>
</h3>
<p>Frequently, it is of interest to classify an experiment as
<em>synergistic</em> or <em>antagonistic</em>. Usually, this has been
done by thresholding the synergy measure at a certain level, declaring
e.g. everything above 10 as synergistic, everything below -10
antagonistic, and anything in between as additive (no interaction). The
problem with this is that it completely ignores the underlying
measurement error, and as a consequence the thresholding procedure can
lead to misclassification. Large synergistic effects might be classified
as synergistic, but in reality the effect cannot be discerned from the
background noise. In the same manner, genuine synergistic effects that
are too small, for example because the dose-ranges are a bit off, will
also be misclassified. By incorporating the uncertainty into the
classification it can be done in a more principled manner.</p>
<p>In Bayesian inference, we can compute what is know as the model
<em>evidence</em>. That is, given a probabilistic model <span class="math inline">\(\mathcal{M}\)</span>, and some data we think is
generated from it, <span class="math inline">\(\mathcal{D}\)</span>, the
evidence is defined as the probability of the model given the data,
<span class="math inline">\(P(\mathcal{M} \vert \mathcal{D})\)</span>.
We can use this quantity to compare different models, in particular when
comparing two distinct models we can define the <strong>Bayes
Factor,</strong> <span class="math inline">\(\text{BF}_{10}\)</span>:
<span class="math display">\[
\text{BF}_{10}=\frac{P(\mathcal{D}\vert\mathcal{M}_1)}{P(\mathcal{D}\vert\mathcal{M}_0)}
= \frac{P(\mathcal{M}_1 \vert \mathcal{D})}{P(\mathcal{M}_0 \vert
\mathcal{D})}\frac{P(\mathcal{M}_1)}{P(\mathcal{M}_0)},
\]</span> where <span class="math inline">\(P(\mathcal{M}_1)\)</span>
and <span class="math inline">\(P(\mathcal{M}_0)\)</span> denotes the
prior model probabilities. By defining <span class="math display">\[
\mathcal{M}_0: f(\mathbf{x}) = p_0(\mathbf{x}) \\
\mathcal{M}_1: f(\mathbf{x}) = p_0(\mathbf{x}) + \Delta(\mathbf{x}),
\]</span> and computing <span class="math inline">\(\text{BF}_{10}\)</span>, the Bayes factor gives
information on whether the interaction surface needs to be included in
the model. A high value indicates that <span class="math inline">\(\mathcal{M}_1\)</span> is preferred over <span class="math inline">\(\mathcal{M}_0\)</span>, and thus that there most
likely is some interaction in the experiment. One still needs to make a
cutoff, but it will be less arbitrary by connecting it directly to the
uncertainty in the model, and model evidence. The thresholding itself
can be done according to e.g. the table in <span class="citation">Kass
and Raftery (1995)</span>:</p>
<table class="table">
<thead><tr class="header">
<th align="center"><span class="math inline">\(\text{BF}_{10}\)</span></th>
<th align="center">Evidence against <span class="math inline">\(\mathcal{M}_0\)</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1 to 3.2</td>
<td align="center">Not worth more than a bare mention</td>
</tr>
<tr class="even">
<td align="center">3.2 to 10</td>
<td align="center">Substantial</td>
</tr>
<tr class="odd">
<td align="center">10 to 100</td>
<td align="center">Strong</td>
</tr>
<tr class="even">
<td align="center">&gt;100</td>
<td align="center">Decisive</td>
</tr>
</tbody>
</table>
<p>The Bayes factor only gives information about whether or not an
interaction is present. Depending on the classification task, one still
needs to decide if the effect is synergistic or antagonistic. For this
one could e.g. use the integral of the interaction surface, <span class="math inline">\(\text{VUS}(\Delta)\)</span>, if this is negative
the experiment is coded as synergistic, if positive it is coded as
antagonistic.</p>
<p>The calculation of the Bayes factor is implemented directly in the
<code>bayesynergy</code> function, and can be calculated simply by
adding <code>bayes_factor = T</code> to the call. Model evidence and the
Bayes factor itself is computed via the <code>bridgesampling</code>
package (<span class="citation">Gronau, Singmann, and Wagenmakers
(2020)</span>).</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Cremaschi_2019" class="csl-entry">
Cremaschi, Andrea, Arnoldo Frigessi, Kjetil Taskén, and Manuela
Zucknick. 2019. <span>“A Bayesian Approach to Study Synergistic
Interaction Effects in in-Vitro Drug Combination Experiments.”</span> <a href="https://arxiv.org/abs/1904.04901" class="external-link">https://arxiv.org/abs/1904.04901</a>.
</div>
<div id="ref-Flaxman_2015" class="csl-entry">
Flaxman, Seth, Andrew Gelman, Daniel Neill, Alex Smola, Aki Vehtari, and
Andrew Gordon Wilson. 2015. <span>“Fast Hierarchical Gaussian
Processes.”</span> <em>Manuscript in Preparation</em>.
</div>
<div id="ref-Gronau2020" class="csl-entry">
Gronau, Quentin F., Henrik Singmann, and Eric-Jan Wagenmakers. 2020.
<span>“Bridgesampling: An r Package for Estimating Normalizing
Constants.”</span> <em>Journal of Statistical Software</em> 92 (10). <a href="https://doi.org/10.18637/jss.v092.i10" class="external-link">https://doi.org/10.18637/jss.v092.i10</a>.
</div>
<div id="ref-Kass1995" class="csl-entry">
Kass, Robert E., and Adrian E. Raftery. 1995. <span>“Bayes
Factors.”</span> <em>Journal of the American Statistical
Association</em> 90 (430): 773–95. <a href="https://doi.org/10.1080/01621459.1995.10476572" class="external-link">https://doi.org/10.1080/01621459.1995.10476572</a>.
</div>
<div id="ref-Yadav_2014" class="csl-entry">
Yadav, Bhagwan, Tea Pemovska, Agnieszka Szwajda, Evgeny Kulesskiy, Mika
Kontro, Riikka Karjalainen, Muntasir Mamun Majumder, et al. 2014.
<span>“Quantitative Scoring of Differential Drug Sensitivity for
Individually Optimized Anticancer Therapies.”</span> <em>Scientific
Reports</em> 4 (1). <a href="https://doi.org/10.1038/srep05193" class="external-link">https://doi.org/10.1038/srep05193</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Leiv Rønneberg, Andrea Cremaschi, Robert Hanes, Chi Zhang, Manuela Zucknick.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
